# セクション6: ファイル操作と例外処理 - 宿題

## 理論問題

1. **Pythonでファイルを開くための基本的な関数は何ですか？また、主なファイルオープンモードを少なくとも4つ挙げて、それぞれの用途を説明してください。**

2. **`with`ステートメントを使用してファイルを操作する利点を説明してください。従来の`open()`と`close()`を使用する方法と比較してください。**

3. **Pythonでファイルパスを操作するための2つの主要なモジュールは何ですか？それぞれの特徴と利点を説明してください。**

4. **バイナリファイルとテキストファイルの違いは何ですか？それぞれを扱う際の注意点を説明してください。**

5. **例外処理の基本構造（`try`, `except`, `else`, `finally`）について説明し、それぞれのブロックの役割を述べてください。**

6. **カスタム例外クラスを作成する利点は何ですか？実際の例を挙げて説明してください。**

7. **コンテキストマネージャとは何ですか？独自のコンテキストマネージャを作成する方法を2つ挙げて説明してください。**

8. **大きなファイルを効率的に処理するための方法を説明してください。メモリ使用量を最小限に抑えるにはどうすればよいですか？**

9. **ファイル操作におけるセキュリティ上の考慮事項を少なくとも3つ挙げて説明してください。**

10. **ログファイルの重要性と、Pythonの`logging`モジュールの基本的な使用方法について説明してください。**

## 実践問題

### 問題1: 基本的なファイル操作

以下の要件を満たすプログラムを作成してください：

1. `fish_data.txt`というファイルを作成し、以下の内容を書き込みます：
   ```
   マグロ,80kg,太平洋
   サケ,5kg,北太平洋
   タイ,3kg,日本海
   サバ,1kg,太平洋
   アジ,0.5kg,日本海
   ```

2. 作成したファイルを読み込み、各行を解析して以下の形式で表示します：
   ```
   魚の名前: マグロ, 重さ: 80kg, 生息地: 太平洋
   ```

3. 新しい魚のデータ（「ブリ,8kg,日本海」と「カツオ,4kg,太平洋」）をファイルに追加します。

4. 更新されたファイルの内容を読み込み、魚の総数と平均重量を計算して表示します。

5. すべての操作で適切な例外処理を行ってください。

```python
# ここにコードを書いてください
```

### 問題2: CSVファイルの操作

以下の要件を満たすプログラムを作成してください：

1. 以下の魚のデータを含むCSVファイル`fish_data.csv`を作成します：
   - ヘッダー行: 名前,重さ(kg),長さ(cm),生息地,価格(円/kg)
   - データ行: 少なくとも5種類の魚のデータ

2. CSVファイルを読み込み、各魚の情報を表形式で表示します。

3. 各魚の総価値（重さ×価格）を計算し、新しい列として追加します。

4. 総価値が高い順に並べ替えて、新しいCSVファイル`sorted_fish_data.csv`に書き込みます。

5. すべての操作で適切な例外処理を行ってください。

```python
# ここにコードを書いてください
```

### 問題3: JSONファイルの操作

以下の要件を満たすプログラムを作成してください：

1. 少なくとも3種類の魚について、以下の情報を含む辞書を作成します：
   - 名前
   - 重さ(kg)
   - 生息地
   - 栄養成分（タンパク質、脂質、炭水化物などの辞書）
   - 料理方法（リスト）

2. この辞書をJSONファイル`fish_info.json`に書き込みます。

3. JSONファイルを読み込み、各魚の詳細情報を整形して表示します。

4. ユーザーから新しい魚のデータを入力してもらい、辞書に追加してJSONファイルを更新します。

5. すべての操作で適切な例外処理を行ってください。

```python
# ここにコードを書いてください
```

### 問題4: 例外処理とカスタム例外

以下の要件を満たすプログラムを作成してください：

1. 魚に関連する以下のカスタム例外クラスを定義します：
   - `FishError`: 基底例外クラス
   - `InvalidFishNameError`: 無効な魚の名前に関するエラー
   - `InvalidWeightError`: 無効な重さに関するエラー
   - `InvalidHabitatError`: 無効な生息地に関するエラー

2. 魚のデータを検証する関数`validate_fish_data(name, weight, habitat)`を作成します。以下の条件を満たさない場合は、適切なカスタム例外を発生させます：
   - 名前は空でなく、アルファベットまたは日本語の文字のみを含む
   - 重さは正の数値
   - 生息地は予め定義されたリスト（例: ['太平洋', '日本海', '東シナ海', '瀬戸内海']）に含まれる

3. ユーザーから魚のデータを入力してもらい、検証関数を使用して検証します。

4. 検証に成功した場合は、データをファイルに保存します。失敗した場合は、適切なエラーメッセージを表示します。

5. すべての操作で適切な例外処理を行ってください。

```python
# ここにコードを書いてください
```

### 問題5: コンテキストマネージャとログ記録

以下の要件を満たすプログラムを作成してください：

1. 魚のデータベースを操作するためのカスタムコンテキストマネージャ`FishDatabase`を作成します。このクラスは以下の機能を持ちます：
   - ファイルを開く（読み込みまたは書き込みモード）
   - データベース操作（読み込み、書き込み、検索など）
   - ファイルを自動的に閉じる
   - 例外処理とログ記録

2. `logging`モジュールを使用して、操作のログを`fish_db.log`ファイルに記録します。ログには以下の情報を含めます：
   - タイムスタンプ
   - ログレベル（INFO, WARNING, ERROR, etc.）
   - 操作の詳細
   - エラーメッセージ（例外が発生した場合）

3. コンテキストマネージャを使用して、以下の操作を行います：
   - 魚のデータの読み込み
   - 新しい魚のデータの追加
   - 特定の条件に基づく魚のデータの検索
   - データベースの更新

4. すべての操作で適切な例外処理を行い、例外が発生した場合はログに記録します。

```python
# ここにコードを書いてください
```

### 問題6: 総合問題 - 魚の在庫管理システム

以下の要件を満たす魚の在庫管理システムを作成してください：

1. 以下の機能を持つシステムを実装します：
   - 魚の追加：名前、重さ、価格、生息地などの情報を入力して在庫に追加
   - 魚の検索：名前、生息地などの条件に基づいて在庫を検索
   - 在庫の更新：既存の魚の情報（重さ、価格など）を更新
   - 在庫の削除：特定の魚を在庫から削除
   - 在庫レポートの生成：現在の在庫状況を表示し、CSVファイルに出力

2. データはJSONファイルに保存し、プログラムの起動時に読み込み、終了時に保存します。

3. すべての操作で適切な例外処理を行い、エラーメッセージを表示します。

4. `logging`モジュールを使用して、すべての操作とエラーをログファイルに記録します。

5. カスタム例外クラスを使用して、特定のエラー状況を処理します。

6. コンテキストマネージャを使用して、ファイル操作とリソース管理を行います。

7. ユーザーフレンドリーなコマンドラインインターフェースを提供します。

```python
# ここにコードを書いてください
```

## 提出方法

1. すべての問題の解答を1つのPythonファイル（`section6_homework_solutions.py`）にまとめてください。
2. 理論問題の解答はコメントとして含めてください。
3. 各実践問題の解答の前に、問題番号と簡単な説明をコメントとして追加してください。
4. ファイルを提出する前に、すべてのコードが正しく動作することを確認してください。

## 評価基準

- 正確性: すべての問題が正しく解かれているか
- コードの品質: コードが読みやすく、効率的で、適切にコメントされているか
- 例外処理: 適切な例外処理が行われているか
- ファイル操作: ファイル操作が正しく行われているか
- 創造性: 特に総合問題での解決策の独創性と完成度

頑張ってください！
